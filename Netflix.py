#!/usr/bin/env python3

# ---------------------------
# projects/collatz/Collatz.py
# Copyright (C) 2016
# Glenn P. Downing
# ---------------------------

import sys

#eager cache filled with some prime numbers and their cycle length
__cache__ = {1: 1, 2:2, 3:8, 5:6, 7:17, 11:15, 13:10, 17:13, 19:21, 23:16, 29:19, 31:107, 37:22, 41:110, 43:30, 47:105, 53:12, 59:33, 61:20, 67:28, 71:103, 73:116, 79:36, 83:111, 89:31, 97:119, 101:26, 103:88, 107:101, 109:114, 113:13, 127:47, 131:29, 137:91, 139:42, 149:24, 151:16, 157:37, 163:24, 167:68, 173:32, 179:32, 181:19, 191:45, 193:120, 197:27, 199:120, 211:40, 223:71, 227:14, 229:35, 233:84, 239:53, 241:22, 251:66, 257:123, 263:79, 269:30, 271:43, 277:17, 281:43, 283:61, 293:118, 307:38, 311:87, 313:131, 317:38, 331:25, 337:113, 347:126, 349:33, 353:126, 359:51, 367:46, 373:20, 379:59, 383:46, 389:121, 397:28, 401:20, 409:41, 419:41, 421:41, 431:41, 433:28, 439:54, 443:54, 449:116, 457:129, 461:36, 463:129, 467:85, 479:54, 487:142, 491:142, 499:49, 503:67, 509:49, 521:124, 523:124, 541:44, 547:31, 557:44, 563:44, 569:57, 571:31, 577:31, 587:119, 593:75, 599:119, 601:57, 607:44, 613:39, 617:132, 619:132, 631:39, 641:52, 643:26, 647:39, 653:26, 659:52, 661:114, 673:65, 677:52, 683:39, 691:127, 701:83, 709:34, 719:52, 727:47, 733:96, 739:21, 743:96, 751:140, 757:109, 761:34, 769:34, 773:122, 787:60, 797:122, 809:47, 811:135, 821:29, 823:135, 827:42, 829:91, 839:86, 853:16, 857:29, 859:148, 863:42, 877:55, 881:117, 883:29, 887:55, 907:55, 911:42, 919:130, 929:130, 937:174, 941:130, 947:37, 953:29, 967:143, 971:37, 977:99, 983:143, 991:99, 997:50, 1009:112, 1013:112, 1019:63, 1021:50, 1031:37, 1033:156, 1039:63, 1049:63, 1051:94, 1061:125, 1063:76, 1069:24, 1087:138, 1091:45, 1093:32, 1097:138, 1103:45, 1109:19, 1117:45, 1123:45, 1129:37, 1151:58, 1153:151, 1163:151, 1171:58, 1181:58, 1187:76, 1193:102, 1201:58, 1213:45, 1217:133, 1223:133, 1229:40, 1231:71, 1237:27, 1249:177, 1259:84, 1277:58, 1279:133, 1283:53, 1289:146, 1291:53, 1297:102, 1301:27, 1303:102, 1307:177, 1319:146, 1321:102, 1327:53, 1361:53, 1367:40, 1373:128, 1381:128, 1399:66, 1409:84, 1423:66, 1427:27, 1429:35, 1433:27, 1439:128, 1447:53, 1451:141, 1453:48, 1459:35, 1471:172, 1481:35, 1483:141, 1487:97, 1489:48, 1493:22, 1499:48, 1511:92, 1523:35, 1531:61, 1543:110, 1549:123, 1553:123, 1559:61, 1567:61, 1571:123, 1579:123, 1583:167, 1597:123, 1601:61, 1607:167, 1609:74, 1613:22, 1619:48, 1621:30, 1627:74, 1637:43, 1657:74, 1663:74, 1667:30, 1669:136, 1693:35, 1697:35, 1699:61, 1709:56, 1721:56, 1723:56, 1733:30, 1741:30, 1747:149, 1753:56, 1759:149, 1777:118, 1783:48, 1787:48, 1789:100, 1801:162, 1811:69, 1823:162, 1831:69, 1847:69, 1861:38, 1867:38, 1871:131, 1873:87, 1877:25, 1879:87, 1889:82, 1901:30, 1907:30, 1913:82, 1931:144, 1933:25, 1949:144, 1951:175, 1973:51, 1979:144, 1987:95, 1993:51, 1997:51, 1999:51, 2003:144, 2011:43, 2017:69, 2027:157, 2029:38, 2039:64, 2053:38, 2063:38, 2069:126, 2081:64, 2083:126, 2087:113, 2089:64, 2099:64, 2111:170, 2113:82, 2129:126, 2131:77, 2137:64, 2141:25, 2143:170, 2153:77, 2161:33, 2179:46, 2203:51, 2207:170, 2213:139, 2221:33, 2237:90, 2239:139, 2243:46, 2251:38, 2267:90, 2269:64, 2273:139, 2281:152, 2287:121, 2293:108, 2297:59, 2309:33, 2311:152, 2333:33, 2339:59, 2341:59, 2347:108, 2351:59, 2357:121, 2371:152, 2377:51, 2381:77, 2383:51, 2389:28, 2393:72, 2399:72, 2411:165, 2417:20, 2423:72, 2437:134, 2441:72, 2447:134, 2459:103, 2467:134, 2473:121, 2477:134, 2503:64, 2521:41, 2531:41, 2539:178, 2543:178, 2549:59, 2551:85, 2557:134, 2579:147, 2591:54, 2593:41, 2609:54, 2617:85, 2621:147, 2633:41, 2647:54, 2657:54, 2659:54, 2663:85, 2671:46, 2677:72, 2683:72, 2687:98, 2689:72, 2693:67, 2699:67, 2707:41, 2711:116, 2713:160, 2719:67, 2729:160, 2731:116, 2741:129, 2749:41, 2753:129, 2767:98, 2777:129, 2789:129, 2791:67, 2797:67, 2801:36, 2803:98, 2819:85, 2833:129, 2837:36, 2843:173, 2851:28, 2857:173, 2861:28, 2879:129, 2887:129, 2897:142, 2903:142, 2909:49, 2917:36, 2927:173, 2939:80, 2953:124, 2957:23, 2963:36, 2969:142, 2971:49, 2999:49, 3001:41, 3011:41, 3019:67, 3023:93, 3037:62, 3041:155, 3049:124, 3061:49, 3067:62, 3079:155, 3083:36, 3089:36, 3109:36, 3119:49, 3121:62, 3137:36, 3163:54, 3167:168, 3169:54, 3181:106, 3187:124, 3191:75, 3203:62, 3209:75, 3217:75, 3221:23, 3229:75, 3251:137, 3253:44, 3257:49, 3259:49, 3271:137, 3299:31, 3301:137, 3307:75, 3313:93, 3319:44, 3323:119, 3329:93, 3331:181, 3343:44, 3347:93, 3359:137, 3361:44, 3371:75, 3373:44, 3389:36, 3391:181, 3407:62, 3413:18, 3433:150, 3449:150, 3457:44, 3461:150, 3463:106, 3467:150, 3469:31, 3491:150, 3499:132, 3511:44, 3517:150, 3527:57, 3529:57, 3533:31, 3539:57, 3541:119, 3547:57, 3557:150, 3559:49, 3571:31, 3581:101, 3583:101, 3593:31, 3607:44, 3613:119, 3617:163, 3623:119, 3631:101, 3637:18, 3643:163, 3659:132, 3671:132, 3673:163, 3677:132, 3691:70, 3697:39, 3701:132, 3709:119, 3719:44, 3727:70, 3733:88, 3739:114, 3761:39, 3767:88, 3769:114, 3779:83, 3793:70, 3797:39, 3803:83, 3821:31, 3823:176, 3833:57, 3847:145, 3851:145, 3853:52, 3863:145, 3877:52, 3881:145, 3889:39, 3907:39, 3911:83, 3917:52, 3919:83, 3923:176, 3929:101, 3931:83, 3943:176, 3947:189, 3967:52, 3989:52, 4001:44, 4003:52, 4007:44, 4013:44, 4019:26, 4021:70, 4027:70, 4049:65, 4051:158, 4057:114, 4073:96, 4079:65, 4091:127, 4093:65, 4099:158, 4111:39, 4127:171, 4129:189, 4133:158, 4139:158, 4153:65, 4157:65, 4159:52, 4177:127, 4201:65, 4211:127, 4217:57, 4219:158, 4229:83, 4231:39, 4241:109, 4243:109, 4253:78, 4259:127, 4261:78, 4271:171, 4273:65, 4283:127, 4289:78, 4297:26, 4327:171, 4337:47, 4339:78, 4349:140, 4357:47, 4363:140, 4373:34, 4391:171, 4397:34, 4409:78, 4421:96, 4423:78, 4441:184, 4447:184, 4451:140, 4457:47, 4463:47, 4481:47, 4483:47, 4493:47, 4507:91, 4513:184, 4517:39, 4519:91, 4523:91, 4547:140, 4549:21, 4561:60, 4567:60, 4583:91, 4591:171, 4597:47, 4603:122, 4621:34, 4637:60, 4639:91, 4643:34, 4649:135, 4651:34, 4657:153, 4663:109, 4673:60, 4679:47, 4691:153, 4703:60, 4721:122, 4723:60, 4729:60, 4733:91, 4751:166, 4759:78, 4783:78, 4787:73, 4789:122, 4793:73, 4799:166, 4801:122, 4813:60, 4817:122, 4831:122, 4861:166, 4871:47, 4877:135, 4889:47, 4903:104, 4909:135, 4919:104, 4931:73, 4933:135, 4937:135, 4943:135, 4951:73, 4957:135, 4967:166, 4969:73, 4973:73, 4987:166, 4993:166, 4999:91, 5003:179, 5009:91, 5011:91, 5021:91, 5023:91, 5039:135, 5051:86, 5059:73, 5077:42, 5081:42, 5087:179, 5099:117, 5101:86, 5107:179, 5113:135, 5119:117, 5147:117, 5153:148, 5167:179, 5171:55, 5179:117, 5189:104, 5197:148, 5209:42, 5227:55, 5231:130, 5233:29, 5237:148, 5261:55, 5273:148, 5279:78, 5281:55, 5297:99, 5303:148, 5309:55, 5323:55, 5333:117, 5347:117, 5351:192, 5381:117, 5387:148, 5393:68, 5399:68, 5407:68, 5413:42, 5417:68, 5419:42, 5431:99, 5437:68, 5441:55, 5443:68, 5449:161, 5471:161, 5477:42, 5479:192, 5483:117, 5501:42, 5503:174, 5507:130, 5519:161, 5521:130, 5527:42, 5531:42, 5557:130, 5563:117, 5569:130, 5573:37, 5581:130, 5591:68, 5623:60, 5639:86, 5641:42, 5647:60, 5651:86, 5653:130, 5657:112, 5659:68, 5669:81, 5683:81, 5689:130, 5693:68, 5701:29, 5711:130, 5717:37, 5737:112, 5741:81, 5743:81, 5749:55, 5779:143, 5783:50, 5791:112, 5801:81, 5807:112, 5813:50, 5821:143, 5827:112, 5839:218, 5843:81, 5849:143, 5851:143, 5857:143, 5861:37, 5867:81, 5869:143, 5879:81, 5881:50, 5897:81, 5903:99, 5923:37, 5927:73, 5939:143, 5953:50, 5981:50, 5987:50, 6007:42, 6011:42, 6029:24, 6037:68, 6043:125, 6047:94, 6053:68, 6067:24, 6073:63, 6079:68, 6089:63, 6091:37, 6101:112, 6113:156, 6121:174, 6131:156, 6133:50, 6143:156, 6151:112, 6163:156, 6173:112, 6197:125, 6199:138, 6203:94, 6211:156, 6217:112, 6221:37, 6229:125, 6247:187, 6257:125, 6263:112, 6269:63, 6271:112, 6277:37, 6287:107, 6299:63, 6301:63, 6311:107, 6317:125, 6323:156, 6329:156, 6337:55, 6343:55, 6353:55, 6359:81, 6361:107, 6367:63, 6373:125, 6379:81, 6389:125, 6397:76, 6421:24, 6427:76, 6449:63, 6451:63, 6469:50, 6473:125, 6481:169, 6491:169, 6521:182, 6529:169, 6547:138, 6551:138, 6553:138, 6563:76, 6569:213, 6571:63, 6577:138, 6581:138, 6599:99, 6607:76, 6619:138, 6637:45, 6653:76, 6659:94, 6661:182, 6673:32, 6679:94, 6689:45, 6691:138, 6701:138, 6703:94, 6709:45, 6719:138, 6733:45, 6737:182, 6761:89, 6763:37, 6779:89, 6781:182, 6791:37, 6793:76, 6803:89, 6823:120, 6827:182, 6829:151, 6833:58, 6841:58, 6857:58, 6863:120, 6869:107, 6871:151, 6883:107, 6899:151, 6907:120, 6911:151, 6917:107, 6947:107, 6949:107, 6959:89, 6961:58, 6967:89, 6971:58, 6977:32, 6983:89, 6991:58, 6997:120, 7001:32, 7013:58, 7019:45, 7027:58, 7039:81, 7043:107, 7057:58, 7069:151, 7079:102, 7103:151, 7109:120, 7121:151, 7127:164, 7129:120, 7151:102, 7159:76, 7177:76, 7187:32, 7193:164, 7207:71, 7211:120, 7213:45, 7219:45, 7229:120, 7237:58, 7243:58, 7247:120, 7253:19, 7283:120, 7297:164, 7307:45, 7309:133, 7321:45, 7331:45, 7333:45, 7349:133, 7351:102, 7369:45, 7393:58, 7411:164, 7417:120, 7433:71, 7451:164, 7457:71, 7459:71, 7477:89, 7481:164, 7487:71, 7489:89, 7499:89, 7507:164, 7517:89, 7523:40, 7529:63, 7537:133, 7541:133, 7547:115, 7549:40, 7559:133, 7561:84, 7573:40, 7577:84, 7583:84, 7589:71, 7591:177, 7603:32, 7607:84, 7621:40, 7639:32, 7643:71, 7649:115, 7669:58, 7673:58, 7681:177, 7687:58, 7691:146, 7699:133, 7703:146, 7717:58, 7723:53, 7727:89, 7741:146, 7753:146, 7757:53, 7759:146, 7789:84, 7793:102, 7817:133, 7823:84, 7829:53, 7841:53, 7853:84, 7867:53, 7873:146, 7877:27, 7879:146, 7883:84, 7901:40, 7907:53, 7919:76, 7927:53, 7933:53, 7937:53, 7949:97, 7951:53, 7963:252, 7993:84, 8009:45, 8011:53, 8017:146, 8039:190, 8053:71, 8059:53, 8069:71, 8081:146, 8087:27, 8089:27, 8093:159, 8101:159, 8111:66, 8117:40, 8123:40, 8147:97, 8161:177, 8167:159, 8171:97, 8179:66, 8191:159, 8209:40, 8219:190, 8221:40, 8231:53, 8233:146, 8237:40, 8243:66, 8263:159, 8269:159, 8273:159, 8287:66, 8291:40, 8293:40, 8297:40, 8311:66, 8317:53, 8329:190, 8353:89, 8363:66, 8369:40, 8377:159, 8387:66, 8389:66, 8419:35, 8423:66, 8429:159, 8431:97, 8443:110, 8447:159, 8461:84, 8467:203, 8501:128, 8513:128, 8521:79, 8527:128, 8537:172, 8539:128, 8543:172, 8563:128, 8573:172, 8581:79, 8597:27, 8599:66, 8609:172, 8623:79, 8627:53, 8629:53, 8641:172, 8647:53, 8663:128, 8669:141, 8677:79, 8681:79, 8689:48, 8693:141, 8699:203, 8707:141, 8713:141, 8719:172, 8731:128, 8737:141, 8741:110, 8747:48, 8753:79, 8761:66, 8779:141, 8783:172, 8803:141, 8807:79, 8819:79, 8821:48, 8831:123, 8837:79, 8839:79, 8849:48, 8861:123, 8863:79, 8867:141, 8887:97, 8893:185, 8923:71, 8929:97, 8933:141, 8941:48, 8951:141, 8963:48, 8969:53, 8971:141, 8999:185, 9001:141, 9007:79, 9011:40, 9013:48, 9029:40, 9041:185, 9043:185, 9049:48, 9059:66, 9067:48, 9091:141, 9103:185, 9109:61, 9127:154, 9133:61, 9137:35, 9151:92, 9157:110, 9161:154, 9173:110, 9181:61, 9187:110, 9199:66, 9203:61, 9209:123, 9221:110, 9227:110, 9239:154, 9241:154, 9257:260, 9277:61, 9281:61, 9283:61, 9293:185, 9311:92, 9319:92, 9323:61, 9337:154, 9341:92, 9343:61, 9349:61, 9371:185, 9377:110, 9391:61, 9397:123, 9403:61, 9413:35, 9419:105, 9421:35, 9431:105, 9433:35, 9437:61, 9439:105, 9461:61, 9463:61, 9467:105, 9473:61, 9479:198, 9491:53, 9497:53, 9511:53, 9521:35, 9533:53, 9539:79, 9547:105, 9551:61, 9587:74, 9601:167, 9613:61, 9619:48, 9623:48, 9629:74, 9631:159, 9643:167, 9649:61, 9661:123, 9677:61, 9679:167, 9689:74, 9697:136, 9719:123, 9721:167, 9733:48, 9739:48, 9743:48, 9749:136, 9767:74, 9769:105, 9781:43, 9787:198, 9791:74, 9803:136, 9811:167, 9817:136, 9829:136, 9833:48, 9839:48, 9851:74, 9857:61, 9859:43, 9871:198, 9883:167, 9887:242, 9901:74, 9907:43, 9923:74, 9929:136, 9931:118, 9941:92, 9949:74, 9967:74, 9973:136, 10007:180, 10009:167, 10037:136, 10039:66, 10061:43, 10067:92, 10069:43, 10079:136, 10091:48, 10093:136, 10099:87, 10103:87, 10111:87, 10133:35, 10139:61, 10141:87, 10151:149, 10159:180, 10163:43, 10169:87, 10177:35, 10181:43, 10193:35, 10211:61, 10223:180, 10243:43, 10247:43, 10253:56, 10259:149, 10267:149, 10271:61, 10273:149, 10289:61, 10301:149, 10303:92, 10313:87, 10321:149, 10331:167, 10333:56, 10337:149, 10343:87, 10357:43, 10369:87, 10391:105, 10399:87, 10427:110, 10429:87, 10433:149, 10453:30, 10457:56, 10459:149, 10463:131, 10477:105, 10487:56, 10499:131, 10501:30, 10513:30, 10529:43, 10531:43, 10559:79, 10567:61, 10589:56, 10597:100, 10601:56, 10607:56, 10613:30, 10627:56, 10631:56, 10639:56, 10651:100, 10657:87, 10663:56, 10667:149, 10687:100, 10691:162, 10709:74, 10711:100, 10723:74, 10729:48, 10733:74, 10739:74, 10753:74, 10771:149, 10781:30, 10789:162, 10799:162, 10831:43, 10837:56, 10847:69, 10853:162, 10859:43, 10861:100, 10867:162, 10883:56, 10889:162, 10891:69, 10903:56, 10909:131, 10937:162, 10939:100, 10949:43, 10957:43, 10973:118, 10979:131, 10987:100, 10993:131, 11003:74, 11027:100, 11047:69, 11057:43, 11059:43, 11069:100, 11071:131, 11083:69, 11087:206, 11093:38, 11113:118, 11117:162, 11119:162, 11131:74, 11149:38, 11159:43, 11161:43, 11171:131, 11173:113, 11177:162, 11197:69, 11213:100, 11239:61, 11243:69, 11251:162, 11257:113, 11261:162, 11273:206, 11279:87, 11287:87, 11299:38, 11311:87, 11317:131, 11321:113, 11329:131, 11351:131, 11353:43, 11369:131, 11383:175, 11393:131, 11399:56, 11411:82, 11423:56, 11437:82, 11443:82, 11447:175, 11467:69, 11471:175, 11483:82, 11489:175, 11491:38, 11497:82, 11503:237, 11519:113, 11527:100, 11549:131, 11551:144, 11579:51, 11587:56, 11593:188, 11597:144, 11617:144, 11621:51, 11633:51, 11657:113, 11677:219, 11681:69, 11689:82, 11699:144, 11701:144, 11717:100, 11719:144, 11731:105, 11743:82, 11777:82, 11779:100, 11783:82, 11789:100, 11801:51, 11807:82, 11813:126, 11821:144, 11827:82, 11831:175, 11833:100, 11839:175, 11863:38, 11867:74, 11887:56, 11897:74, 11903:126, 11909:144, 11923:51, 11927:51, 11933:144, 11939:95, 11941:144, 11953:51, 11959:56, 11969:51, 11971:95, 11981:51, 11987:82, 12007:69, 12011:43, 12037:43, 12041:188, 12043:51, 12049:43, 12071:43, 12073:43, 12097:69, 12101:69, 12107:69, 12109:69, 12113:69, 12119:144, 12143:113, 12149:64, 12157:157, 12161:64, 12163:64, 12197:126, 12203:64, 12211:113, 12227:157, 12239:64, 12241:64, 12251:157, 12253:64, 12263:144, 12269:64, 12277:64, 12281:126, 12289:51, 12301:157, 12323:38, 12329:188, 12343:263, 12347:51, 12373:126, 12377:64, 12379:69, 12391:64, 12401:126, 12409:95, 12413:95, 12421:157, 12433:113, 12437:38, 12451:38, 12457:64, 12473:201, 12479:87, 12487:87, 12491:64, 12497:157, 12503:113, 12511:113, 12517:113, 12527:232, 12539:139, 12541:64, 12547:64, 12553:64, 12569:157, 12577:38, 12583:263, 12589:126, 12601:157, 12611:64, 12613:64, 12619:64, 12637:126, 12641:157, 12647:95, 12653:56, 12659:157, 12671:157, 12689:82, 12697:38, 12703:144, 12713:108, 12721:108, 12739:108, 12743:82, 12757:126, 12763:126, 12781:77, 12791:126, 12799:170, 12809:126, 12821:64, 12823:51, 12829:51, 12841:162, 12853:25, 12889:77, 12893:25, 12899:64, 12907:77, 12911:170, 12917:77, 12919:77, 12923:77, 12941:51, 12953:170, 12959:108, 12967:108, 12973:51, 12979:51, 12983:170, 13001:126, 13003:126, 13007:64, 13009:139, 13033:157, 13037:51, 13043:183, 13049:201, 13063:139, 13093:139, 13099:51, 13103:139, 13109:46, 13121:46, 13127:51, 13147:64, 13151:77, 13159:214, 13163:139, 13171:139, 13177:170, 13183:245, 13187:126, 13217:51, 13219:139, 13229:77, 13241:121, 13249:77, 13259:77, 13267:77, 13291:77, 13297:139, 13309:77, 13313:95, 13327:69, 13331:95, 13337:69, 13339:170, 13367:95, 13381:139, 13397:46, 13399:139, 13411:46, 13417:121, 13421:95, 13441:90, 13451:139, 13457:139, 13463:46, 13469:90, 13477:183, 13487:139, 13499:183, 13513:38, 13523:90, 13537:64, 13553:38, 13567:183, 13577:90, 13591:38, 13597:121, 13613:64, 13619:183, 13627:64, 13633:64, 13649:121, 13669:59, 13679:64, 13681:59, 13687:139, 13691:152, 13693:152, 13697:152, 13709:33, 13711:90, 13721:64, 13723:59, 13729:59, 13751:90, 13757:152, 13759:121, 13763:121, 13781:108, 13789:59, 13799:64, 13807:64, 13829:46, 13831:90, 13841:108, 13859:152, 13873:183, 13877:33, 13879:90, 13883:152, 13901:108, 13903:113, 13907:90, 13913:152, 13921:108, 13931:165, 13933:90, 13963:90, 13967:90, 13997:134, 13999:90, 14009:152, 14011:152, 14029:59, 14033:196, 14051:59, 14057:183, 14071:108, 14081:59, 14083:59, 14087:59, 14107:134, 14143:59, 14149:33, 14153:152, 14159:103, 14173:59, 14177:152, 14197:59, 14207:152, 14221:121, 14243:152, 14249:103, 14251:51, 14281:103, 14293:77, 14303:103, 14321:103, 14323:134, 14327:59, 14341:77, 14347:77, 14369:152, 14387:165, 14389:121, 14401:165, 14407:72, 14411:121, 14419:72, 14423:121, 14431:72, 14437:46, 14447:157, 14449:59, 14461:72, 14479:46, 14489:165, 14503:165, 14519:165, 14533:72, 14537:59, 14543:165, 14549:20, 14551:134, 14557:165, 14561:165, 14563:20, 14591:90, 14593:46, 14621:121, 14627:121, 14629:121, 14633:59, 14639:152, 14653:72, 14657:134, 14669:46, 14683:72, 14699:46, 14713:103, 14717:165, 14723:134, 14731:72, 14737:46, 14741:134, 14747:103, 14753:165, 14759:46, 14767:196, 14771:72, 14779:196, 14783:95, 14797:72, 14813:134, 14821:165, 14827:121, 14831:240, 14843:121, 14851:134, 14867:72, 14869:134, 14879:147, 14887:46, 14891:134, 14897:116, 14923:72, 14929:72, 14939:72, 14947:103, 14951:72, 14957:116, 14969:72, 14983:165, 15013:165, 15017:209, 15031:209, 15053:41, 15061:134, 15073:90, 15077:116, 15083:90, 15091:72, 15101:90, 15107:134, 15121:85, 15131:222, 15137:46, 15139:134, 15149:85, 15161:85, 15173:72, 15187:178, 15193:72, 15199:59, 15217:33, 15227:147, 15233:85, 15241:178, 15259:85, 15263:178, 15269:85, 15271:85, 15277:33, 15287:72, 15289:72, 15299:116, 15307:85, 15313:85, 15319:178, 15329:85, 15331:59, 15349:134, 15359:240, 15361:178, 15373:147, 15377:147, 15383:147, 15391:178, 15401:147, 15413:54, 15427:85, 15439:54, 15443:116, 15451:59, 15461:147, 15467:85, 15473:28, 15493:54, 15497:165, 15511:54, 15527:116, 15541:41, 15551:147, 15559:85, 15569:222, 15581:85, 15583:72, 15601:147, 15607:147, 15619:147, 15629:41, 15641:108, 15643:147, 15647:85, 15649:147, 15661:103, 15667:59, 15671:59, 15679:85, 15683:54, 15727:85, 15731:54, 15733:147, 15737:85, 15739:54, 15749:129, 15761:147, 15767:85, 15773:178, 15787:178, 15791:85, 15797:41, 15803:191, 15809:191, 15817:41, 15823:77, 15859:147, 15877:147, 15881:129, 15887:147, 15889:54, 15901:54, 15907:98, 15913:103, 15919:222, 15923:147, 15937:54, 15959:54, 15971:54, 15973:54, 15991:54, 16001:147, 16007:85, 16033:46, 16057:54, 16061:46, 16063:235, 16067:98, 16069:28, 16073:191, 16087:54, 16091:98, 16097:46, 16103:85, 16111:147, 16127:191, 16139:191, 16141:72, 16183:191, 16187:160, 16189:160, 16193:67, 16217:67, 16223:67, 16229:116, 16231:191, 16249:98, 16253:67, 16267:129, 16273:160, 16301:160, 16319:129, 16333:67, 16339:67, 16349:160, 16361:160, 16363:72, 16369:67, 16381:160, 16411:67, 16417:116, 16421:160, 16427:160, 16433:160, 16447:191, 16451:116, 16453:41, 16477:41, 16481:98, 16487:98, 16493:98, 16519:67, 16529:142, 16547:160, 16553:98, 16561:160, 16567:98, 16573:67, 16603:160, 16607:129, 16619:41, 16631:204, 16633:204, 16649:90, 16651:67, 16657:67, 16661:129, 16673:160, 16691:116, 16693:129, 16699:116, 16703:235, 16729:67, 16741:41, 16747:111, 16759:160, 16763:116, 16787:129, 16811:67, 16823:67, 16829:111, 16831:111, 16843:67, 16871:59, 16879:85, 16883:59, 16889:59, 16901:59, 16903:204, 16921:85, 16927:111, 16931:85, 16937:147, 16943:59, 16963:111, 16979:67, 16981:129, 16987:111, 16993:85, 17011:85, 17021:204, 17027:129, 17029:41, 17033:160, 17041:80, 17047:129, 17053:129, 17077:67, 17093:67, 17099:54, 17107:54, 17117:80, 17123:28, 17137:28, 17159:54, 17167:80, 17183:142, 17189:28, 17191:142, 17203:67, 17207:173, 17209:80, 17231:80, 17239:142, 17257:173, 17291:98, 17293:36, 17299:54, 17317:54, 17321:173, 17327:142, 17333:142, 17341:67, 17351:129, 17359:173, 17377:160, 17383:54, 17387:85, 17389:186, 17393:142, 17401:80, 17417:142, 17419:142, 17431:142, 17443:49, 17449:111, 17467:54, 17471:142, 17477:49, 17483:49, 17489:111, 17491:54, 17497:80, 17509:80, 17519:80, 17539:142, 17551:142, 17569:173, 17573:142, 17579:142, 17581:129, 17597:103, 17599:142, 17609:49, 17623:54, 17627:54, 17657:124, 17659:129, 17669:98, 17681:80, 17683:142, 17707:49, 17713:111, 17729:142, 17737:49, 17747:173, 17749:23, 17761:173, 17783:72, 17789:186, 17791:72, 17807:98, 17827:49, 17837:49, 17839:217, 17851:72, 17863:98, 17881:49, 17891:49, 17903:98, 17909:93, 17911:98, 17921:93, 17923:49, 17929:217, 17939:54, 17957:93, 17959:93, 17971:186, 17977:49, 17981:80, 17987:80, 17989:49, 18013:41, 18041:142, 18043:41, 18047:98, 18049:67, 18059:186, 18061:41, 18077:93, 18089:186, 18097:49, 18119:41, 18121:41, 18127:93, 18131:124, 18133:67, 18143:93, 18149:67, 18169:67, 18181:142, 18191:142, 18199:124, 18211:155, 18217:49, 18223:67, 18229:62, 18233:186, 18251:62, 18253:155, 18257:155, 18269:62, 18287:186, 18289:36, 18301:124, 18307:155, 18311:155, 18313:67, 18329:36, 18341:155, 18353:111, 18367:124, 18371:186, 18379:62, 18397:155, 18401:124, 18413:124, 18427:168, 18433:93, 18439:49, 18443:49, 18451:230, 18457:80, 18461:93, 18481:155, 18493:155, 18503:186, 18517:36, 18521:49, 18523:142, 18539:155, 18541:93, 18553:62, 18583:36, 18587:62, 18593:155, 18617:93, 18637:155, 18661:137, 18671:186, 18679:155, 18691:186, 18701:62, 18713:199, 18719:85, 18731:85, 18743:186, 18749:155, 18757:155, 18773:124, 18787:111, 18793:111, 18797:85, 18803:62, 18839:106, 18859:111, 18869:62, 18899:62, 18911:155, 18913:62, 18917:62, 18919:106, 18947:62, 18959:199, 18973:62, 18979:155, 19001:54, 19009:124, 19013:54, 19031:54, 19037:80, 19051:199, 19069:106, 19073:54, 19079:80, 19081:54, 19087:54, 19121:80, 19139:80, 19141:75, 19157:124, 19163:155, 19181:168, 19183:137, 19207:199, 19211:80, 19213:168, 19219:75, 19231:168, 19237:49, 19249:49, 19259:75, 19267:49, 19273:137, 19289:168, 19301:62, 19309:106, 19319:168, 19333:75, 19373:168, 19379:75, 19381:75, 19387:75, 19391:80, 19403:75, 19417:23, 19421:124, 19423:62, 19427:49, 19429:168, 19433:106, 19441:49, 19447:106, 19457:49, 19463:168, 19469:49, 19471:49, 19477:137, 19483:199, 19489:49, 19501:124, 19507:124, 19531:137, 19541:44, 19543:137, 19553:75, 19559:80, 19571:199, 19577:75, 19583:106, 19597:137, 19603:106, 19609:168, 19661:137, 19681:137, 19687:106, 19697:75, 19699:75, 19709:212, 19717:44, 19727:75, 19739:212, 19751:168, 19753:62, 19759:98, 19763:168, 19777:137, 19793:243, 19801:137, 19813:44, 19819:124, 19841:49, 19843:137, 19853:44, 19861:44, 19867:124, 19889:75, 19891:75, 19913:75, 19919:75, 19927:75, 19937:75, 19949:168, 19961:75, 19963:75, 19973:168, 19979:168, 19991:67, 19993:67, 19997:93}

#constants for the maximum cycle length from 1 to 1,000,000
MAX_NUMBER = 837799
MAX_CYCLE = 525 

#is the range flipped?
flipped = False


# ------------
# collatz_read
# ------------

def collatz_read(s):
	"""
	read two ints
	s a string
	return a list of two ints, representing the beginning and end of a range, [i, j]
	"""
	a = s.split()
	return [int(a[0]), int(a[1])]


# -------------
# collatz_print
# -------------

def collatz_print(w, i, j, v):
	"""
	print three ints
	w a writer
	i the beginning of the range, inclusive
	j the end	   of the range, inclusive
	v the max cycle length
	"""
	global flipped
	if(not flipped):
		w.write(str(i) + " " + str(j) + " " + str(v) + "\n")
	else:
		w.write(str(j) + " " + str(i) + " " + str(v) + "\n")


# -------------
# collatz_solve
# -------------

def collatz_solve(reader, writer):
	"""
	r a reader
	w a writer
	if given the range flipped, i.e end < begin, the program will compute the cycle range and output the result in the same result received 
	"""
	collatz_eager()
	global flipped

	for line in reader:
		if (len(line.split()) == 2):
			#flipped
			if (int(line.split()[0]) > int(line.split()[1])):
				flipped = True
				end, begin = collatz_read(line)
				
			else: #same order
				flipped = False
				begin, end = collatz_read(line)

			if((end//2) > begin):
				#print("1 begin is " + str(begin) + " end is " + str(end) + " -->" + str(end//2))
				result = collatz_eval(end//2, end)
			else:
				#print("2 begin is " + str(begin) + " end is " + str(end))
				result = collatz_eval(begin, end)
				
			collatz_print(writer, begin, end, result)
		else:
			break


# ------------
# collatz_eval
# ------------

def collatz_eval(begin, end):
	"""
	begin the beginning of the range, inclusive
	end the end of the range, inclusive
	return the max cycle length of the range [i, j]
	"""
	#for unit testing purposes, although program should not execute this if when called from collatz_solve()
	if(begin > end):
		tmp = begin
		begin = end
		end = tmp

	assert begin >= 0
	assert end >= begin

	counter = 0

	if (begin <= MAX_NUMBER <= end):
		return MAX_CYCLE

	for number in range(begin, end + 1):
		if number in __cache__:
			if counter < __cache__[number]:
				counter = __cache__[number]
		else:
			__cache__[number] = collatz_recursion(number)
			if counter < __cache__[number]:
				counter = __cache__[number]
	return counter


# -------------
# collatz_cycle
# -------------
def collatz_cycle(n):
	"""
	returns the cycle length of a number n
	n is an int
	returns the solution for the collatz conjucture
	currently not called by solve() since the recursive solution is faster
	"""
	assert n > 0

	counter = 1

	while n != 1:

		if (n % 2) == 0:
			n = n >> 1
			counter += 1

		else:
			n = n + (n >> 1) + 1
			counter += 2  # skips two steps

	return counter

# -----------------
# collatz_recursion
# -----------------
def collatz_recursion(n):
	"""
	returns the cycle length of a number n
	n is an int
	recursive solution to the problem, lazy cache
	"""
	if n <= 1 :
		return 1

	elif n in __cache__:
		return __cache__[n]
	
	elif (n % 2) == 0:
		__cache__[n] = 1 + collatz_recursion(n >> 1)
		return __cache__[n]

	else:
		__cache__[n] = 2 + collatz_recursion(n + (n >> 1) + 1)
		return __cache__[n]


# -------------
# collatz_eager
# -------------
def collatz_eager():
	"""
	fills the cache dict with powers of two and the max_cycle_length
	"""
	# powers of two
	for power in range(0, 21):
		__cache__[2 ** power] = collatz_recursion(2 ** power)

	#longest cycle length
	__cache__[837799] = 525



